{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///D:/KULIAH%20SMT%207/Chatbot-Gen-AI-main/app/api/generate-image/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport Groq from 'groq-sdk';\r\n\r\nconst groq = new Groq({\r\n    apiKey: process.env.GROQ_API_KEY || ''\r\n});\r\n\r\nexport async function POST(req: NextRequest) {\r\n    try {\r\n        const { prompt } = await req.json();\r\n\r\n        if (!prompt || typeof prompt !== 'string') {\r\n            return NextResponse.json(\r\n                { error: 'Prompt is required and must be a string' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        console.log('Generating image for prompt:', prompt);\r\n\r\n        // Step 1: Gunakan Llama untuk translate & enhance prompt (Indonesia â†’ English)\r\n        let enhancedPrompt = prompt;\r\n        \r\n        if (process.env.GROQ_API_KEY) {\r\n            try {\r\n                const completion = await groq.chat.completions.create({\r\n                    messages: [\r\n                        {\r\n                            role: \"system\",\r\n                            content: \"You are an expert at creating image generation prompts. Translate Indonesian to English and create a detailed, high-quality prompt for Stable Diffusion. Include style descriptors like 'highly detailed, 8k uhd, studio lighting, professional, vivid colors'. Keep under 77 tokens. Return ONLY the prompt.\"\r\n                        },\r\n                        {\r\n                            role: \"user\",\r\n                            content: prompt\r\n                        }\r\n                    ],\r\n                    model: \"llama-3.3-70b-versatile\",\r\n                    temperature: 0.7,\r\n                    max_tokens: 100,\r\n                });\r\n\r\n                enhancedPrompt = completion.choices[0]?.message?.content?.trim() || prompt;\r\n                console.log('Enhanced prompt:', enhancedPrompt);\r\n            } catch (error) {\r\n                console.log('Llama enhancement failed, using original prompt');\r\n            }\r\n        }\r\n\r\n        // Step 2: Generate gambar dengan Pollinations.ai (free & unlimited)\r\n        const cleanPrompt = enhancedPrompt.substring(0, 200).trim();\r\n        const encodedPrompt = encodeURIComponent(cleanPrompt);\r\n        \r\n        // Pollinations.ai - Simple & reliable\r\n        const imageUrl = `https://image.pollinations.ai/prompt/${encodedPrompt}?width=1024&height=1024&nologo=true&seed=${Date.now()}`;\r\n        \r\n        console.log('Image URL generated:', imageUrl);\r\n\r\n        return NextResponse.json({ \r\n            imageUrl,\r\n            prompt: prompt,\r\n            enhancedPrompt: enhancedPrompt,\r\n            method: 'pollinations-ai'\r\n        });    } catch (error: any) {\r\n        console.error('Error generating image:', error);\r\n        return NextResponse.json(\r\n            { error: error.message || 'Gagal membuat gambar' },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,OAAO,IAAI,kKAAI,CAAC;IAClB,QAAQ,QAAQ,GAAG,CAAC,YAAY,IAAI;AACxC;AAEO,eAAe,KAAK,GAAgB;IACvC,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,IAAI,IAAI;QAEjC,IAAI,CAAC,UAAU,OAAO,WAAW,UAAU;YACvC,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAA0C,GACnD;gBAAE,QAAQ;YAAI;QAEtB;QAEA,QAAQ,GAAG,CAAC,gCAAgC;QAE5C,+EAA+E;QAC/E,IAAI,iBAAiB;QAErB,IAAI,QAAQ,GAAG,CAAC,YAAY,EAAE;YAC1B,IAAI;gBACA,MAAM,aAAa,MAAM,KAAK,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;oBAClD,UAAU;wBACN;4BACI,MAAM;4BACN,SAAS;wBACb;wBACA;4BACI,MAAM;4BACN,SAAS;wBACb;qBACH;oBACD,OAAO;oBACP,aAAa;oBACb,YAAY;gBAChB;gBAEA,iBAAiB,WAAW,OAAO,CAAC,EAAE,EAAE,SAAS,SAAS,UAAU;gBACpE,QAAQ,GAAG,CAAC,oBAAoB;YACpC,EAAE,OAAO,OAAO;gBACZ,QAAQ,GAAG,CAAC;YAChB;QACJ;QAEA,oEAAoE;QACpE,MAAM,cAAc,eAAe,SAAS,CAAC,GAAG,KAAK,IAAI;QACzD,MAAM,gBAAgB,mBAAmB;QAEzC,sCAAsC;QACtC,MAAM,WAAW,CAAC,qCAAqC,EAAE,cAAc,yCAAyC,EAAE,KAAK,GAAG,IAAI;QAE9H,QAAQ,GAAG,CAAC,wBAAwB;QAEpC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB;YACA,QAAQ;YACR,gBAAgB;YAChB,QAAQ;QACZ;IAAO,EAAE,OAAO,OAAY;QAC5B,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO,MAAM,OAAO,IAAI;QAAuB,GACjD;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}